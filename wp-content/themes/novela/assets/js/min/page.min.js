jQuery(document).ready(function(n){"use strict";function i(i){n(".main-content").prepend(i),e=function(){function i(){o("init"),t()}function t(){p.on("click",function(){return b.next(),!1}),v.on("click",function(){return b.prev(),!1}),l.on({swipeleft:function(){return c.data("opened")?!1:(b.next(),!1)},swiperight:function(){return c.data("opened")?!1:(b.prev(),!1)}}),w.on("click",s),k.on("click",function(){var i=n(this),t=i.index(),o=function(){b.jump(t+1)};return f!==t?d(o):d(),!1}),n(window).on("debouncedresize",function(){o("reinit")})}function o(n,i){var i=void 0===i?f:i,t=l.eq(i).children("div.book-content"),o=t.data("jsp");"init"===n&&void 0===o?t.jScrollPane({verticalGutter:0,hideFocus:!0}):"reinit"===n&&void 0!==o?o.reinitialise():"destroy"===n&&void 0!==o&&o.destroy()}function a(n){0===f?(p.show(),v.hide()):n?(p.hide(),v.show()):(p.show(),v.show())}function s(){var n=c.data("opened");n?d():r()}function r(){p.hide(),v.hide(),c.addClass("slideRight").data("opened",!0)}function d(i){a(f===h-1),c.removeClass("slideRight").data("opened",!1),i&&(g?c.on(x,function(){n(this).off(x),i.call()}):i.call())}var c=n("#book-container"),u=n("#bb-bookblock"),l=u.children(),h=l.length,f=0,b=n("#bb-bookblock").bookblock({speed:800,perspective:2e3,shadowSides:.8,shadowFlip:.4,onEndFlip:function(n,i,t){f=i,e.updateTOC(),e.updateNavigation(t),e.setJSP("init"),e.setJSP("destroy",n)}}),p=n("#bb-nav-next"),v=n("#bb-nav-prev").hide(),k=c.find("ul.menu-toc > li"),w=n("#tblcontents"),m={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},x=m[Modernizr.prefixed("transition")],g=Modernizr.csstransitions;return{init:i,setJSP:o}}(),e.init()}function t(){n(".book-container, .bb-custom-wrapper, .bb-bookblock").css({width:n(window).width(),height:n(window).height()})}Array.prototype.allValuesSame=function(){for(var n=1;n<this.length;n++)if(this[n]!==this[0])return!1;return!0};var o=[],e=null;n(".read-book-button").each(function(){var i=n(this).data("id");i&&o.push(i)});var a=o.allValuesSame();a&&n.ajax({type:"post",dataType:"html",url:sdesignsAjax.ajaxurl,data:{action:"sdesigns_ajax_function",id:o[0]},success:function(n){i(n)}}),n(window).on("resize",function(){t()}),n(".read-book-button").on("click",function(o){if(o.preventDefault(),!a){var s=n(this).data("id");n.ajax({type:"post",dataType:"html",url:sdesignsAjax.ajaxurl,data:{action:"sdesigns_ajax_function",id:s},success:function(){i()}})}n("#book-container").addClass("showBook"),t(),e.setJSP("reinit"),n(".header").hide(),n("#book-container .menu-toc > li").eq(0).addClass("menu-toc-current")}),n(document).on("click",".bb-nav-close",function(){var i=n(this);i.parents("#book-container").removeClass("showBook"),n(".header").show()})});